# Configuración de la aplicación
quarkus.application.name=identity-service
quarkus.http.port=8081

# Configuración de base de datos reactiva
quarkus.datasource.db-kind=mysql
quarkus.datasource.username=root
quarkus.datasource.password=root
quarkus.datasource.reactive.url=mysql://localhost:3306/altokeapp

# Configuración de Hibernate Reactive
quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.log.sql=true

# Configuración de OpenAPI
quarkus.swagger-ui.always-include=true
quarkus.swagger-ui.path=/swagger-ui
quarkus.swagger-ui.enable=true
# Mostrar todas las operaciones expandidas
quarkus.swagger-ui.doc-expansion=list
# Habilitar modo "Try it out" por defecto
quarkus.swagger-ui.filter=false
quarkus.smallrye-openapi.servers=http://localhost:8081

# Configuración de seguridad en Swagger
quarkus.smallrye-openapi.info-title=Identity Service API
quarkus.smallrye-openapi.info-version=1.0.0
quarkus.smallrye-openapi.info-description=API para gestión de identidad y registro de usuarios

# === JWT Config ===
mp.jwt.verify.publickey.location=keys/publicKey.pem
mp.jwt.verify.issuer=altokeapp-identity-service

# Para firmar tokens (solo en el servicio que los emite)
smallrye.jwt.sign.key-location=keys/privateKey.pem

# Asegura que el algoritmo sea RS256
smallrye.jwt.sign.algorithm=RS256

# Propiedades JWT para JwtTokenAdapter (aunque no todas se usan en el código actual)
jwt.issuer=altokeapp-identity-service
jwt.secret=not-used-rs256-keys-pem
jwt.temporary.expiration=300

# JWT - Access Token (1 hora = 3600 segundos)
jwt.access.expiration=3600

# JWT - Refresh Token (30 días = 2592000 segundos)
jwt.refresh.expiration=2592000

# ======================


# Permitir endpoint /register solo con JWT
quarkus.http.auth.permission.register.paths=/identity/register
quarkus.http.auth.permission.register.policy=authenticated

# Endpoints públicos (sin JWT)
quarkus.http.auth.permission.public.paths=/identity/register/request-otp,/identity/register/verify-otp
quarkus.http.auth.permission.public.policy=permit

# Endpoints públicos para login
quarkus.http.auth.permission.login-request-otp.paths=/identity/login/request-otp
quarkus.http.auth.permission.login-request-otp.policy=permit

quarkus.http.auth.permission.login-verify-otp.paths=/identity/login/verify-otp
quarkus.http.auth.permission.login-verify-otp.policy=permit

quarkus.http.auth.permission.login-logout.paths=/identity/login/logout
quarkus.http.auth.permission.login-logout.policy=permit

# Endpoint público para refresh
quarkus.http.auth.permission.refresh.paths=/identity/refresh
quarkus.http.auth.permission.refresh.policy=permit

# Logs generales (opcional)
quarkus.log.level=INFO

# Detalle de JWT/seguridad
quarkus.log.category."io.smallrye.jwt".level=DEBUG
quarkus.log.category."io.quarkus.smallrye.jwt".level=DEBUG
quarkus.log.category."io.quarkus.security".level=DEBUG
quarkus.log.category."io.quarkus.vertx.http.runtime.security".level=DEBUG